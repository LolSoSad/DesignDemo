<!doctype html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏£‡∏û.‡∏™‡∏ï.</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      /* 70% cool blue + 30% light green */
      --blue-900:#0B3A86;
      --blue-800:#0E4AA6;
      --blue-700:#1463D6;
      --blue-600:#1E7BF2;
      --blue-500:#3A98FF;

      --mint-500:#34D399;
      --mint-200:#CFFAEA;
      --mint-100:#E9FFF7;

      --bg:#F6FAFF;
      --card:#FFFFFF;
      --text:#0F172A;
      --muted:#64748B;
      --border:#E2E8F0;
      --shadow: 0 12px 34px rgba(2, 6, 23, .10);
      --radius: 18px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:"Prompt", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1100px 520px at 15% -10%, rgba(58,152,255,.22), rgba(246,250,255,0) 60%),
        radial-gradient(980px 520px at 90% 0%, rgba(52,211,153,.14), rgba(246,250,255,0) 55%),
        var(--bg);
    }

    .topbar{
      position: sticky;
      top: 0;
      z-index: 20;
      background: rgba(246,250,255,.88);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(226,232,240,.9);
    }
    .topbar-inner{
      max-width: 1200px;
      margin: 0 auto;
      padding: 12px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap: 12px;
      min-width: 280px;
    }
    .logo{
      width: 44px;
      height: 44px;
      border-radius: 14px;
      background: #fff;
      border: 1px solid rgba(226,232,240,.95);
      box-shadow: 0 10px 18px rgba(30,123,242,.14);
      display:grid;
      place-items:center;
      overflow:hidden;
      flex: 0 0 auto;
    }
    .logo img{ width: 30px; height:auto; }
    .brand-title{ line-height: 1.15; }
    .brand-title b{ display:block; font-size: 14px; }
    .brand-title span{ display:block; font-size: 12px; color: var(--muted); }

    .status{
      display:flex;
      align-items:center;
      gap: 12px;
      justify-content:flex-end;
      min-width: 280px;
    }
    .pill{
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(30,123,242,.10);
      border: 1px solid rgba(30,123,242,.18);
      color: var(--blue-800);
      white-space: nowrap;
    }
    .progress{
      width: 240px;
      height: 10px;
      border-radius: 999px;
      background: rgba(30,123,242,.10);
      border: 1px solid rgba(30,123,242,.12);
      overflow:hidden;
    }
    .progress > div{
      width: 0%;
      height: 100%;
      border-radius: 999px;
      background: linear-gradient(90deg, rgba(52,211,153,.95), rgba(58,152,255,.95), rgba(11,58,134,.95));
      transition: width .25s ease;
    }

    .layout{
      max-width: 1200px;
      margin: 14px auto 28px;
      padding: 0 16px;
      display:grid;
      grid-template-columns: 360px 1fr;
      gap: 16px;
      align-items: stretch;
    }

    .notice{
      grid-column: 1 / -1;
      background: rgba(255,255,255,.78);
      border: 1px solid rgba(226,232,240,.95);
      border-left: 4px solid rgba(52,211,153,.75);
      border-radius: 16px;
      padding: 12px 14px;
      box-shadow: 0 10px 18px rgba(2,6,23,.06);
      display:flex;
      gap: 10px;
      align-items:flex-start;
    }
    .notice .icon{
      width: 32px; height: 32px;
      border-radius: 999px;
      display:grid; place-items:center;
      background: rgba(52,211,153,.14);
      border: 1px solid rgba(52,211,153,.22);
      flex: 0 0 auto;
      font-weight: 700;
      color: #0f766e;
    }
    .notice b{ color: var(--blue-900); }
    .notice p{ margin:0; font-size: 12.5px; color: #1f2937; line-height: 1.45; }

    .panel{
      background: rgba(255,255,255,.72);
      border: 1px solid rgba(226,232,240,.95);
      border-radius: 22px;
      box-shadow: var(--shadow);
      overflow:hidden;
      position: sticky;
      top: 78px;
      height: calc(100vh - 120px);
      min-height: 520px;
      display:flex;
      flex-direction:column;
    }
    .panel-top{
      padding: 18px 16px 12px;
      border-bottom: 1px solid rgba(226,232,240,.9);
      background: linear-gradient(180deg, rgba(233,255,247,.55), rgba(246,250,255,1));
    }
    .panel-center{
      padding: 18px 16px;
      display:flex;
      gap: 14px;
      align-items:center;
    }
    .botmark{
      width: 52px; height: 52px;
      border-radius: 999px;
      background:
        radial-gradient(circle at 30% 30%, rgba(52,211,153,.35), rgba(52,211,153,0) 55%),
        radial-gradient(circle at 70% 40%, rgba(58,152,255,.35), rgba(58,152,255,0) 60%),
        #fff;
      border: 1px solid rgba(226,232,240,.95);
      display:grid;
      place-items:center;
      box-shadow: 0 10px 18px rgba(2,6,23,.06);
      flex:0 0 auto;
    }
    .botmark span{
      width: 30px; height: 30px;
      border-radius: 10px;
      background: linear-gradient(135deg, rgba(58,152,255,.18), rgba(52,211,153,.16));
      display:grid; place-items:center;
      border: 1px solid rgba(226,232,240,.9);
      font-size: 16px;
    }
    .panel-title b{ display:block; font-size: 15px; color: var(--blue-900); }
    .panel-title p{ margin: 4px 0 0; font-size: 12.5px; color: var(--muted); line-height: 1.45; }

    .panel-list{ padding: 0 16px 16px; overflow:auto; }
    .check{
      display:flex; gap: 10px;
      padding: 10px 12px;
      border-radius: 16px;
      background: rgba(58,152,255,.06);
      border: 1px solid rgba(58,152,255,.12);
      margin-top: 10px;
    }
    .check .dot{
      width: 22px; height: 22px;
      border-radius: 999px;
      background: rgba(52,211,153,.18);
      border: 1px solid rgba(52,211,153,.24);
      display:grid; place-items:center;
      flex: 0 0 auto;
      color: #0f766e;
      font-size: 12px;
      font-weight: 700;
    }
    .check b{ font-size: 13px; }
    .check span{ display:block; font-size: 12px; color: var(--muted); margin-top: 2px; }

    .chat-shell{
      background: rgba(255,255,255,.80);
      border: 1px solid rgba(226,232,240,.95);
      border-radius: 22px;
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 680px;
    }
    .chat-head{
      padding: 14px 16px;
      border-bottom: 1px solid rgba(226,232,240,.9);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      background: linear-gradient(180deg, rgba(246,250,255,.70), rgba(246,250,255,1));
    }
    .chat-head .left{ display:flex; align-items:center; gap: 10px; min-width: 240px; }
    .chip{
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(52,211,153,.14);
      border: 1px solid rgba(52,211,153,.22);
      color: #0f766e;
      white-space: nowrap;
    }
    .chat-head h3{ margin:0; font-size: 14px; color: var(--blue-900); }
    .chat-head .sub{ font-size: 12px; color: var(--muted); }

    .btn{
      border:0;
      border-radius: 999px;
      padding: 10px 14px;
      font-size: 13px;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      user-select:none;
      transition: transform .05s ease, opacity .2s ease;
    }
    .btn:active{ transform: translateY(1px); }
    .btn-ghost{ background: transparent; color: var(--muted); }
    .btn-ghost:hover{ background: rgba(100,116,139,.08); }

    .chat{
      flex:1;
      padding: 16px;
      overflow:auto;
      background:
        radial-gradient(900px 420px at 10% 0%, rgba(58,152,255,.10), rgba(255,255,255,0) 55%),
        radial-gradient(900px 420px at 90% 0%, rgba(52,211,153,.08), rgba(255,255,255,0) 55%),
        #fff;
    }
    .row{ display:flex; margin: 10px 0; }
    .row.bot{ justify-content:flex-start; }
    .row.me{ justify-content:flex-end; }

    .bubble{
      max-width: min(720px, 92%);
      padding: 11px 12px;
      border-radius: 16px;
      border: 1px solid rgba(226,232,240,.92);
      background: #fff;
      box-shadow: 0 10px 18px rgba(2,6,23,.06);
      line-height: 1.45;
      white-space: pre-line;
    }
    .bubble.me{
      background: linear-gradient(135deg, rgba(20,99,214,.95), rgba(58,152,255,.95));
      color:#fff;
      border: 1px solid rgba(20,99,214,.22);
      box-shadow: 0 12px 22px rgba(20,99,214,.18);
    }

    .meta{
      display:flex;
      align-items:center;
      gap: 10px;
      margin-bottom: 6px;
      color: var(--muted);
      font-size: 11px;
    }
    .bubble.me .meta{ color: rgba(255,255,255,.85); }

    .avatar{
      width: 24px; height: 24px;
      border-radius: 999px;
      background: rgba(58,152,255,.10);
      border: 1px solid rgba(58,152,255,.18);
      display:grid;
      place-items:center;
      flex: 0 0 auto;
      font-size: 12px;
    }
    .bubble.me .avatar{ background: rgba(255,255,255,.18); border-color: rgba(255,255,255,.24); }

    .quick{ display:flex; gap: 8px; flex-wrap:wrap; margin-top: 10px; }
    .qbtn{
      border: 1px solid rgba(58,152,255,.18);
      background: rgba(58,152,255,.10);
      color: var(--blue-900);
      padding: 8px 10px;
      border-radius: 999px;
      font-size: 13px;
      cursor:pointer;
      user-select:none;
      transition: transform .05s ease, background .2s ease, border-color .2s ease;
    }
    .qbtn:hover{ border-color: rgba(58,152,255,.32); background: rgba(58,152,255,.14); }
    .qbtn:active{ transform: translateY(1px); }
    .qbtn.mint{ border-color: rgba(52,211,153,.22); background: rgba(52,211,153,.14); color:#0f766e; }

    .composer{
      border-top: 1px solid rgba(226,232,240,.9);
      padding: 12px;
      background: linear-gradient(180deg, rgba(246,250,255,.65), rgba(246,250,255,1));
      display:flex;
      gap: 10px;
      align-items:flex-end;
      flex-wrap:wrap;
    }
    .input{
      flex: 1 1 360px;
      min-width: 220px;
      border: 1px solid rgba(226,232,240,.95);
      border-radius: 16px;
      padding: 10px 12px;
      background:#fff;
      outline:none;
      font-size: 14px;
      transition: box-shadow .2s ease, border-color .2s ease;
    }
    .input:focus{ border-color: rgba(58,152,255,.55); box-shadow: 0 0 0 4px rgba(58,152,255,.12); }
    .input[disabled]{ background: rgba(226,232,240,.35); }

    .btn-primary{
      background: linear-gradient(90deg, rgba(52,211,153,.95), rgba(58,152,255,.95));
      color:#0b1220;
      font-weight: 600;
    }

    .error{ width:100%; color:#b91c1c; font-size: 12px; display:none; }
    .error.show{ display:block; }

    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
      .panel{ position: relative; top: 0; height: auto; }
      .status{ min-width:auto; }
      .brand{ min-width:auto; }
      .progress{ width: 160px; }
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="logo"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIgAAABJCAYAAADmDm5DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAABT9SURBVHgB7V0LWFRV1157nzMzwACCokVqWpnXpJKLiPmLXSzLC2mY4GCaT5Zd/FPRL8u+f7K7XOzP/yu1TAsQha80ssi+LlipyMXU1MrsibzfEhQYmDlz9v7XGRwC5sJBgVGb93nmmXP22bez99prr73W2vsAeOGFF1544YUXXnjhhRdeeOGFF160PcInpw+MMqTdDJwT8BA8VrAa9Ls9sQfl1giB8etlzjtRCjpoIRbcTy3dguuuqWiVRcJkV3EJgZODJ21YCirwzaqpPj4+FZOAMSkkWPr3jffmmxs+D0tKuU4HZLzAiQgXAAYQDBxmIWlQYDyxeE3yR+ABXFDl2xL9Y+Ovpow8hp01EWSpL/Ya4XhDyYXRcu5WLj8xShL050mLu4nL8eHWtXH8MNW8PXFiruwuX1/f8qdxYL8KSLV/ntWGYlCq/VmvUW/qfJhlHdY9ksFFgNSNYIu5Khr//t4EclVYkj4k2PwE5fwpTnhXhTBag8EdOEGEDws1bMpwScms+Qw5LOlusZzCq3Uuo3AghdlkQH1ulATan4XPmKGhNdalwEkkxtzDBTpJMJuroYWQRe01mP1rWFSAoPV/DzyES4JAwmLHd2PM/C6SxN1KH7rtRc6/xgjrsQMS8X8IqMC2/YR08BP5uEhrswRClDYRyNLi7LH7IxPyfnAWpzAzbjjGmoCXfyDTKag1Wd6yPxNq+sznnE+vqyv8KMh8NIhap2Uhd5Fqqyszd683nnTyuCw+PmcE8kDIzXXPzdoSHpdB+g+dMIBq6KdIFj2ajcyh9nRAUKdjG1eYcCryx5BbQCU0OBTemiYl44wwTk18zvhB2SoPG/bQxoMNw7dlx/VEAijB+laJIrs7cmLeL/ZnEUnpkwTOVyHR+IAqsBeKelUvAqPxomaitgQFD6JfzPgegih8pIo4EIos3/nMKYUwwFKjDeLAQtT+rDKtPGmpmIqd+62asggl14pa4b3/LL+zgz3sy3fGXkU4X08UuYjzRxsSx60JKUMIY2+rJw7IrjL3eOVSJg4FHuUgA4dP/AprcHt9AIFvCYcivJqKDR3iLA3O/8WEss85oxNwSuoPasHhOBB5xLJHeA2m34YvHqouHX9r0/5bnxreo0Dr4xP0PoZMlGU28zZD3jJ7lCFT0rvKjBXgC/RSlSWQHbXMfOePaxaUwyWOViGQ3uGjQ7QBflMZI5Wi1bJ+99b1J5tL02vUKJ1fjf+YhmHWk3vz9u3bZxk4LH44ygEF0NrgsF828eEr57AehMifI7EFqUiF8z8zItMIxPjJ+DPGJH68yP5wYOKrwT5U+xU25K2gCuRXsxlG7MqdcwQuA1y0kBo6erSfttJ3DTbQXQLlwDXi2LDYB1/EVQh3m7AWFPI81DhwAP72ARGFWs7bgPMS6E318G7Cgj8fWPtqx1k49bxHmm8DAeebhYzjegRIplzDltgf9I83an2I9m21xIENUoH6nCm7cudeFsSh4KI5yM13PNibybwUL/3hIoGdkIsj9WskrcexZgNtgRyOYjXXYufs5BTOMieUQxmjMqV+aspAeQezsWwZHxt2dGSfXakE+GxQh+21tXDPiGkbKmx3RiONOhDwvHKlLjmvZYxPK1kzby1cRrhoAgkNn+HXyb98J3bsjeeD9mCXpblLgyN3Phbcz20cjIRM6K0a36rnDuTnn4M2wNaceF8iW1ZhMzzoPiY/gVPToNum5x21h0RNTn0IueQKvNRCM8B3QV0fX1iUmfwKXGZoFRnkltj4W2ROZ2KfysDp0j3frvvJVdyoqCmdan1rd+OK5Bq3mXKe3rcLzG9rHQASSUciS9+DK4IlUG5l1rHDEjd+bw+KNKTFIOfZiA+DVRShEMg7+iOVjxcUGK1wmaHdVzEDR8SH43gqBPdz//FKOHldWUFBLbQDCjPH9UcJ4wvsyq5NHknIDWcMSfhotT0g3PByqAA+O/DyalWZA9l+UjwXW7ba2C7v0tpodz0IzhsK53ArGDLgq9uLOBREGz7exwh/GAnE1DBcIPzVTb+EfWC/D49/rQPlPhtAJXGgruQXXFonXK7EoaDdCQSFzZDm49A90M4YOmnDFyglJ4NNA25DzumTlleM5xVZ/eP/5S/4iIqlN1JllicJoY8UZcz7HS5jtDuBEEaaLROJyCNzdfSvg5aj4PkejvydXKiZee+sv0z4el3tbJwakwhRMS0TYLiye7ooc853cJnDo6r2Sw0EuUV5YO2TJoneGTNx0xl7eIQh7VFcer2gOh/G5pZkJ2fDFYBLzh/E07i3zvGnnnNEJaXejZzjZVSfqHEVQC06LLPqq1fAFQIvB3GD8KlL+3Km6Dp4JzXxOeGbBTOZW7rCaIIrBF4CcYGwpGS9IJk/RJnjWpVJfifU8sC23Dk1cAXhkpxiUDHVYt/T1kTsVKOPSQp8D6cVVdZinFmOyzKP25H57J9whaH99SBcPtNcHCpQ1Y5AbQBikv1fwE6PVxm/BgWPJ3dkz9ttD1i1KlatT8glj/bXgzD6BzQQAp2CwYO9Bo8KBA8gypA6HYWJp1UtZ0EheHi2JHNuvUNxYU5ceB9dh22bs0bfCFcA2p1ATP7iAeTJ7rkI2ml0PnojtLMpICppye1YpGLOb9YApwA1aCv9j1T+H5x3lt+RPfYaWYKVaLi8RUOE97d/dL8q4fZShgDtjDMHfjRfdd2AEXjZ2108bOTILj36+/uRLt9VVJS1ueIsetKSnoywj5FzdFaVgMO35yqtD5VuWmhToy9fPkPTSWfKoQSGKvdY/+7cyq7pPjD0k4KCsgt2bvkuJ/7aJ+70Na3YeMwjrokecTm8aUT8fYTDJ7atSs2CH0draAYjchElQquuEIjMuLa67D9S/0nBOkY2Y6f2VZMO5ZM9GsLv2Joxr95zblt23Cr8m9oof5vpCZYzzjfDBYASMhTTPomz3a8itw6NSNx4GtoZHlnFUI1PAbOYdxFVXunkamzkeYJSVQ6tCSunwksQGl6gY3QZlqGKODDeceBWw9aMZ2zEkZMTL3SXLclIDQlN64e3FIl7JqaaCRcAZsuPKPn0NhHxZrz5CtoZHtGD7P4io5pT+Cd4EoR/tgf6vywE9pmHnX6/ylRVjJNpRZnP7LIH9ODSGFzFvIy92CpLc8zr3/g3wvbjZC6pMx4W+QlVJeABeNSrPWzEgx+gYSwJ2h/FNYcrh3UccpcBbfKKd3o9J8XR+hsaCxfXXXNlO2VA3RNi4owlNdwjuy173GDs0O9JK3JiLNMKMjwUY/h4jXKft3y035gZn9SQ5nx82wjtQiB9xr4e0EFPb5KsugM/5M46VR8+dGyAVuM3AdoRhHFmoeTbgZ3HHyrTHBwHAmm0nBYsdHvhutk2j7hIQ9rz2ECLFHaDxDEbieNNaDDRKZ3XOVD8Gi8HQ+uiBmR21xBD3hbwMNpBBuGkQ1D6ei7D7aJW+gUto2+Ah4Fr2Lt/tznUEwe5RmLm+jYhSBVAqOL4867+aNW/oEnssY9uNG1eNTpJ4yN+hjmp2hOjEr6ckve/e//ee4c99Nl+8CDanIP0RLV1F2uACTw8nakFEsMhAkIKshoNUsOLWO2iarNuzL7cJ6pcpdm+5v4hnLAvcbpR5VnfgroUaXsfvi0iolQCD6FdOi3asCQN59YJyKfzuUZY7jKiVR6AS7p5OE7DgFwKBEV21xL5rt0NlrOusHVNXAIKu4p7YutyZQJLox/c8N+EwJUrgyiImvJKpzOn/KsO5M9yq2YPS0rR+zAYiQssZVtBFI4jRXHV7stxbJgTVk7uKs2a86Oa+DjaSeG68S/ixXPQikDCsDIZHouZvGEleACXNNuPSUrpYiFCT5QFuuEAClZ2l0A7gVFSWvLB3B9akuazN0fpOnTSTeSEt6o1WqD0TO3P5XkjjAWX3bYJL7zwwgsvvPDCiwvBZaGb8KJl2Pr+6K4oKNfvGxb0rCJ6Qv7hpvG+Mcb6+Fyvv46dd/uQqcjkA2f3NxSGvU7LVyC4RtOHajSb8fej8gOLrmjLmtGNDvzblDJS79Onw2rQiHvPx9stUHg6FmIb+Z14CeQKxNDE9V+LBNAQCZXKPWrYQikRN27JirO5VxiNsWJgN79ldcde1KkOOIPMLqctT5EmZ6Z5p5grGIVZY8ZxKig7/HyVe1Tm/cZF8gC1QgIamuY1cNj6SDaxqbdNz6tsmodbAhkSn97RClYH/0xWYzpXutH95iDleKYgqz5IErmNS1FR4n+GBFQcWOpekxofnyMcFI+GVForyvflGi1Nn0fGL75aTfnKCUAxu/Qh9vLtUOph3f/HmdLSFZKregeImmBm1Thtm/KqQ+UH8pe6eAcjDbsfQnSiX6Myia+fVFSzuQKaOetkSPxsXyuEdnD1XKn79uznFLW/arX7lrVxM7EyS+z+KkgSFcgtAoHUzx7fc0EzMmZirlNvPaeNcGti6n+JAnmDcFdnb/EjfqJwU8Hq2RUOj8JnaCL79llMCH8Ms2/s/s+5FWu4Upb5wtLsZKfucxGJr79LqTgdyfAnkGhc0bq5jayZUYY0HAiwt6el8GZXh8tETk59HMtZ6OokQ7QL5RVnJjs9LxVN/G9hOpceYFj2vuKsuQOcpk1MXUgoXVR3YKdDwmogQp5sNj9TmvvMwaaPFRMDmnB38maswkyyzC9ZtyAFWoDCteMeR0vA/0ITkwWW9R31Y/HR4/JOuErrYOOInvpqT1mCTGDQDantCGq3HUca51XV1ZLTvR9R/fo8iwXPQuKowk463vAZtloIPntUoESDt9OdpbdWn+2kDVCcwWk/rN2miMSUR0rWzPuyUT6EdyjWD8A8HAnk/F7aN2zFEVLmrAzKwKXKGhN1rhugfCfeOZzrQQhx7ZFPyNV1xMEPA6F/laF8rYEox16wBKrV6GNjYycUFDRWm3es9SM1utrTGK+uTzjDf9INU1Zg4vqBWFv5Z4stxp///PGykX3iRmHFRjcINskMZse4IQ4FDgRiqZZiRZ22O46UjVY///GlKx5VbWqONRpF0698MjYi9oFlXEnGgoIGj0l00ut9ORdLOZdH3zrqqc4/5C895TIzzrcph+FTIDkRk1JnlKxN/hBUsFY0uU/DhtBgnyTf1+vcEuMFH1RLMpAQi+x3TGZV+qOmPWqOkaJYdmHmnIZnvZMIQ+oj+C7LcdBFnwm+ryNAQSMLcUGdO0H9SmPw5NejORG3YUNu2J41ZxpcBEb2HqMIo3c2aT4/kcKL36yKHT9imuvDehwIxHzuVJDYWa/4yRS2hDhsKMP8SJ1AVJLZiDgU8MKMf/w02JB2hHEeUn7sVz2GuSQQ7NUXKbGdwJxORciOTEr7p/5QZUqzu6IZ6BVWRUHaYry4U4zTGn6mhQrCzyc7d1YOj6lqLiEjMCVycnq9QzYaGrGf+T3nb49ppOpm82gtFGaOewDJ4h1sfjvHVw4EtHvRjdLpgteULB9tiHh0o9OmdVjmir5BthGCgkyPln7IplJ7VLaz1vD41xw2Pfefnt5RIQ6FwQiB17sV2AijvChjzjKc4pQTCKuQ+F8ydQtcDM0AuZdtNHDQXA8XAa583oPzmfYfCj6Lupw6pfYoqXuR+zxj/yGFzEfuEYazTxmuHv7RrIDdSijMjBvJBfouNooyGJV3OsZlGI91qj+KkxAWJwXSN3Ny+jvdLObAQbS+wd9gVmcxkyQU2LqBIfVs0ziEkXIt+D73/ZrHGx0lXbpihRRlSN2CMXpSnSY/0pCqHCX11yg2s5uwA4Ow0zcPuurU0d+geRRnzPkkMiE9jlCegY3b7JmmqEH8FIXrB/A/bfDktAmMcIeVEOHkt6KsuQvdZsS4IoP9RRAcutZ09f8fFICri7OSX3ObFPgKHHnFDQrkAudHwEcs2rYyudm9ya2BkrXjB0lMzsJL26oIR3o1Y2zSUEPet4WZo4qBakOQOu48v9R9+Fprr5Oc732uqXO0A4EUZ8/ZO9iQPhslfVyJkFFOS6f8cJVoftbZIxnM8wTw7Yxs9S4s3HF3PIdCQUOn5mY6X4EIvv41Tuq0OTwhdaQgkEy8Dcc3kPyqwen0UXxD5QdRBwJuw7eehPxvvDPHNCQeN/tLmNkmqlIyyZnAg81Xhn9uCQSJI78oM3kDXAyYzsQFmV2IompL5phIibNP6gRjsK2gUKaMGzo5z/Yhg2hD/rlNH4yMC9D45WP+w2xiPyHzi9bFIYOH5xt6r7ksX3HWwbniJiY7TkNcFs+Urpu9w1XaIbPTfeVj0gBGaaOz0AXCcO713bc9a5bLg3Fvjn+pq1br29dqMe/+IffZRjLKEJyipBp5ENGKp4tXz94JrkFunfxKPxF0oZw7trEkmX/albvQ6XHYkVMXXw2SMMBZOltaWTq4a92zTh2JBycuvpEBDZVMVbt3bjBWwEUiKiFlCM7Z5agS+Lkl6b7PGdtHkMTu9nsmm4/HJG3c25Q7/LA+LshUQwahUF3Xxwy1P/0ObfGkD6wXXnjhhRdeeOHF3xiu9TsxDy2+AVoBkZPT7ohMTFkUHr5cAxcARUDlHvygsh1tvt+kbp+L+IRkqVnFJUu9dMwC9NLujHm2z4UOmpxiIFaruXTdgtym6SMNKRMJEQLk8nPZTRVMUYb0YVZJOh3oqz3W1HAYmbB4eHH2/M1N84tKWhzPWVq/4ixY1LSelhOHbpatVDlLXo2K5nw56cOVZXjTcFwu9EXD3bGAgGyH1XLEpNfHEip2Lc6as8zZh5ciE1LGcJHeHhGxQtnRL/WMNfoEBTX+Fp7W3z/WapYO7chdUAptiDZ3GFKMUKgdqdH4BPj7BHUIsv/8AfT2OCKBINOZP5wY/2wbYVCja5XkkA6Omj4O3YkoDK8GR8Mhp9TpSUHMSjqi0s1hids1SGf1Dwm9CRUdAdACUMqcloOqhC7Y86yy8z16hzQaUYcN/0fYlHlODW+yqRJVCVBRWlpn6gi9IdCvYdspP0XTTKmf+7PeWgFtzkHOG6Hcfu68lsAqDXHG2Qn3E41LjzOt/ufV8x30CrJenytWnu7oWxbjcPwk1wd85qwsiwiZmlrZ4b3zl84yD3349ewTep0FWgCzRvjSWbhoOfJajf5a3c7MZxw00bKv/6fa8mq+OyulFjJSHdIGnqX5FcG0/pz3bSvnKNrXphrYMvDCCy+88MILL7zwwou/I/4ftkc9QxWF51sAAAAASUVORK5CYIK22WOR/4I+dIOFXrBwtvjdLIv2zi9/CewmI3Xw71Kehg==" alt="Logo"/></div>
        <div class="brand-title">
          <b>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏£‡∏û.‡∏™‡∏ï.</b>
          <span>ChatBot ‡∏ñ‡∏≤‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ ‚Ä¢ ‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á</span>
        </div>
      </div>

      <div class="status">
        <span class="pill" id="stepText">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</span>
        <div class="progress" aria-label="progress"><div id="progressBar"></div></div>
      </div>
    </div>
  </header>

  <main class="layout">
    <div class="notice" role="note" aria-label="disclaimer">
      <div class="icon">i</div>
      <p>
        <b>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏ó‡∏£‡∏≤‡∏ö:</b> ‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô AI ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
        <u>‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡πÇ‡∏£‡∏Ñ</u> ‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á/‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÇ‡∏ó‡∏£ <b>1669</b> ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
      </p>
    </div>

    <aside class="panel">
      <div class="panel-top">
        <div class="panel-center">
          <div class="botmark"><span>ü§ñ</span></div>
          <div class="panel-title">
            <b>‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡πà‡∏ß‡∏¢</b>
            <p>‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏ä‡∏ó ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á</p>
          </div>
        </div>
      </div>
      <div class="panel-list">
        <div class="check"><div class="dot">1</div><div><b>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</b><span>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• ‚Ä¢ ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î ‚Ä¢ ‡πÄ‡∏û‡∏® ‚Ä¢ ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</span></div></div>
        <div class="check"><div class="dot">2</div><div><b>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</b><span>‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å ‚Ä¢ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á</span></div></div>
        <div class="check"><div class="dot">3</div><div><b>‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</b><span>‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß ‚Ä¢ ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡∏π‡πà ‚Ä¢ ‡πÅ‡∏û‡πâ‡∏¢‡∏≤/‡∏≠‡∏≤‡∏´‡∏≤‡∏£</span></div></div>
        <div class="check"><div class="dot">4</div><div><b>‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</b><span>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span></div></div>
      </div>
    </aside>

    <section class="chat-shell" aria-label="chatbot">
      <div class="chat-head">
        <div class="left">
          <span class="chip" id="sectionChip">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</span>
          <div>
            <h3>Smart Care Chat</h3>
            <div class="sub" id="sectionSub">‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠ (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°)</div>
          </div>
        </div>
        <button class="btn btn-ghost" type="button" id="btnReset">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
      </div>

      <div class="chat" id="chat"></div>

      <div class="composer">
        <input class="input" id="input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö..." autocomplete="off" />
        <button class="btn btn-primary" id="btnSend" type="button">‡∏™‡πà‡∏á ‚û§</button>
        <div class="error" id="err">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</div>
      </div>
    </section>
  </main>

<script>
  const chat = document.getElementById('chat');
  const input = document.getElementById('input');
  const btnSend = document.getElementById('btnSend');
  const err = document.getElementById('err');
  const btnReset = document.getElementById('btnReset');
  const sectionChip = document.getElementById('sectionChip');
  const sectionSub = document.getElementById('sectionSub');
  const stepText = document.getElementById('stepText');
  const progressBar = document.getElementById('progressBar');

  const state = {
    firstName:'', lastName:'', phone:'', gender:'', birthDate:'',
    symptom:'', duration:'', severity:'',
    diseases:[], meds:'', allergy:''
  };

  const steps = [
    { section:'‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô', progress:8,
      ask:'‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ üëã\n‡∏â‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠ Smart Care Chat ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏Ñ‡πà‡∏∞\n\n‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å ‚Äú‡∏ä‡∏∑‡πà‡∏≠‚Äù ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡∏∞?',
      type:'text', validate:v=>v.trim().length>0, save:v=>state.firstName=v.trim()
    },
    { section:'‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô', progress:16,
      ask:()=>`‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞ ${esc(state.firstName)} üòä\n‚Äú‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‚Äù ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡∏∞?`,
      type:'text', validate:v=>v.trim().length>0, save:v=>state.lastName=v.trim()
    },
    { section:'‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô', progress:24,
      ask:'‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏Ñ‡∏∞?\n(‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö 0xx-xxx-xxxx)',
      type:'phone', validate:v=>v.replace(/\D/g,'').length>=9, save:v=>state.phone=formatPhone(v)
    },
    { section:'‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô', progress:32,
      ask:'‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚Äú‡πÄ‡∏û‡∏®‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î‚Äù ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡πà‡∏∞',
      type:'choice',
      choices:[{label:'‡πÄ‡∏û‡∏®‡∏ä‡∏≤‡∏¢',value:'male'},{label:'‡πÄ‡∏û‡∏®‡∏´‡∏ç‡∏¥‡∏á',value:'female'}],
      validate:v=>['male','female'].includes(v), save:v=>state.gender=v
    },
    { section:'‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô', progress:40,
      ask:'‡∏ß‡∏±‡∏ô / ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô / ‡∏õ‡∏µ ‡πÄ‡∏Å‡∏¥‡∏î ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡πÑ‡∏´‡∏ô‡∏Ñ‡∏∞?',
      type:'date', validate:v=>!!v, save:v=>state.birthDate=v
    },
    { section:'‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô', progress:52,
      ask:'‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ ‚Äú‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£‚Äù ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡∏∞?\n‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏Ç‡πâ ‡πÑ‡∏≠ ‡πÄ‡∏à‡πá‡∏ö‡∏Ñ‡∏≠ ‡∏õ‡∏ß‡∏î‡∏ó‡πâ‡∏≠‡∏á ‡∏ó‡πâ‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢ ‡∏õ‡∏ß‡∏î‡∏´‡∏±‡∏ß',
      type:'text', validate:v=>v.trim().length>0, save:v=>state.symptom=v.trim()
    },
    { section:'‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô', progress:62,
      ask:'‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ô‡∏≤‡∏ô‡πÅ‡∏Ñ‡πà‡πÑ‡∏´‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏∞?',
      type:'choice',
      choices:[
        {label:'‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 24 ‡∏ä‡∏°.',value:'<24h'},
        {label:'1-3 ‡∏ß‡∏±‡∏ô',value:'1-3d'},
        {label:'4-7 ‡∏ß‡∏±‡∏ô',value:'4-7d'},
        {label:'‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå',value:'>1w'}
      ],
      validate:v=>['<24h','1-3d','4-7d','>1w'].includes(v), save:v=>state.duration=v
    },
    { section:'‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô', progress:72,
      ask:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ (‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°) ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÑ‡∏´‡∏ô‡∏Ñ‡∏∞?',
      type:'choice',
      choices:[
        {label:'‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢',value:'mild'},
        {label:'‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á',value:'moderate'},
        {label:'‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á',value:'severe'}
      ],
      validate:v=>['mild','moderate','severe'].includes(v), save:v=>state.severity=v
    },
    { section:'‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°', progress:82,
      ask:'‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ ‚Äú‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‚Äù ‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞?\n‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏Ñ‡∏ó‡∏µ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°\n‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î ‚Äú‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‚Äù',
      type:'disease', validate:v=>true, save:v=>{}
    },
    { section:'‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°', progress:90,
      ask:'‡∏°‡∏µ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞? (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏¥‡∏°‡∏û‡πå ‚Äú-‚Äù)',
      type:'text', validate:v=>v.trim().length>0, save:v=>state.meds=(v.trim()==='-'?'':v.trim())
    },
    { section:'‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°', progress:95,
      ask:'‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ ‚Äú‡πÅ‡∏û‡πâ‡∏¢‡∏≤/‡πÅ‡∏û‡πâ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‚Äù ‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞? (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏¥‡∏°‡∏û‡πå ‚Äú-‚Äù)',
      type:'text', validate:v=>v.trim().length>0, save:v=>state.allergy=(v.trim()==='-'?'':v.trim())
    },
    { section:'‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô', progress:100, ask:()=>summaryText(), type:'confirm' }
  ];

  let idx = 0;

  function nowTime(){ const d=new Date(); return d.toLocaleTimeString('th-TH',{hour:'2-digit',minute:'2-digit'}); }
  function esc(str){ return String(str??'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])); }
  function scrollDown(){ chat.scrollTop = chat.scrollHeight; }

  function renderQuick(choices){
    const chips = choices.map(c=>`<div class="qbtn ${c.mint?'mint':''}" data-choice="${c.value}" data-label="${esc(c.label)}">${esc(c.label)}</div>`).join('');
    return `<div class="quick">${chips}</div>`;
  }
  function bindQuick(scope){
    scope.querySelectorAll('[data-choice]').forEach(el=>{
      el.addEventListener('click',()=>sendAnswer(el.dataset.choice,true,el.dataset.label));
    });
  }

  function botBubble(text, quickChoices){
    const row=document.createElement('div');
    row.className='row bot';
    row.innerHTML=`
      <div class="bubble">
        <div class="meta"><div class="avatar">ü§ñ</div><span>Smart ‚Ä¢ ${nowTime()}</span></div>
        <div>${text}</div>
        ${quickChoices?renderQuick(quickChoices):''}
      </div>`;
    chat.appendChild(row); scrollDown(); bindQuick(row);
  }

  function meBubble(text){
    const row=document.createElement('div');
    row.className='row me';
    row.innerHTML=`
      <div class="bubble me">
        <div class="meta"><div class="avatar">üôÇ</div><span>‡∏Ñ‡∏∏‡∏ì ‚Ä¢ ${nowTime()}</span></div>
        <div>${esc(text)}</div>
      </div>`;
    chat.appendChild(row); scrollDown();
  }

  function formatPhone(v){
    const raw=String(v).replace(/\D/g,'').slice(0,10);
    let out=raw;
    if(raw.length>=4) out=raw.slice(0,3)+'-'+raw.slice(3);
    if(raw.length>=7) out=raw.slice(0,3)+'-'+raw.slice(3,6)+'-'+raw.slice(6);
    return out;
  }

  function setHeader(section, progress){
    sectionChip.textContent = section;
    stepText.textContent = section + ' ‚Ä¢ ‡∏Ç‡πâ‡∏≠ ' + (Math.min(idx+1, steps.length)) + '/' + steps.length;
    progressBar.style.width = (progress||0) + '%';
    sectionSub.textContent =
      section==='‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô' ? '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' :
      (section==='‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°' ? '‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß ‚Ä¢ ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡∏π‡πà ‚Ä¢ ‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡πâ' :
      (section==='‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô' ? '‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ ‚Ä¢ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á' : '‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß'));
  }

  function summaryText(){
    const genderLabel = state.gender==='male'?'‡πÄ‡∏û‡∏®‡∏ä‡∏≤‡∏¢':(state.gender==='female'?'‡πÄ‡∏û‡∏®‡∏´‡∏ç‡∏¥‡∏á':'-');
    const durationLabel = ({'<24h':'‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 24 ‡∏ä‡∏°.','1-3d':'1-3 ‡∏ß‡∏±‡∏ô','4-7d':'4-7 ‡∏ß‡∏±‡∏ô','>1w':'‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 ‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå'})[state.duration]||'-';
    const severityLabel = ({mild:'‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢',moderate:'‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á',severe:'‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á'})[state.severity]||'-';
    const diseases = (state.diseases&&state.diseases.length)?state.diseases.join(', '):'‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß';
    const meds = state.meds?state.meds:'-';
    const allergy = state.allergy?state.allergy:'-';

    const t = `
<b>‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏£‡∏≠‡∏Å</b> ‚úÖ
‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞

‚Ä¢ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•: <b>${esc(state.firstName)} ${esc(state.lastName)}</b>
‚Ä¢ ‡πÇ‡∏ó‡∏£: <b>${esc(state.phone)}</b>
‚Ä¢ ‡πÄ‡∏û‡∏®‡∏Å‡∏≥‡πÄ‡∏ô‡∏¥‡∏î: <b>${esc(genderLabel)}</b>
‚Ä¢ ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î: <b>${esc(state.birthDate)}</b>

‚Ä¢ ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å: <b>${esc(state.symptom)}</b>
‚Ä¢ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤: <b>${esc(durationLabel)}</b>
‚Ä¢ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á: <b>${esc(severityLabel)}</b>

‚Ä¢ ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß: <b>${esc(diseases)}</b>
‚Ä¢ ‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡∏π‡πà: <b>${esc(meds)}</b>
‚Ä¢ ‡πÅ‡∏û‡πâ‡∏¢‡∏≤/‡∏≠‡∏≤‡∏´‡∏≤‡∏£: <b>${esc(allergy)}</b>

‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ‚Äú‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Äù ‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞?`;
    return t.trim().replaceAll('\n','<br>');
  }

  function renderDiseaseBubble(){
    const existing=document.getElementById('disease-bubble');
    if(existing) existing.remove();

    const row=document.createElement('div');
    row.className='row bot';
    row.id='disease-bubble';

    const list = (state.diseases&&state.diseases.length)
      ? state.diseases.map(d=>`<div class="qbtn mint" data-remove="${esc(d)}">‚úï ${esc(d)}</div>`).join('')
      : `<div class="qbtn mint" style="cursor:default">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</div>`;

    row.innerHTML=`
      <div class="bubble">
        <div><b>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß</b></div>
        <div class="quick" style="margin-top:8px">${list}</div>
        <div style="margin-top:8px;color:#64748B;font-size:12px">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÇ‡∏£‡∏Ñ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Enter ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° ‚Ä¢ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÇ‡∏£‡∏Ñ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö</div>
      </div>`;
    chat.appendChild(row); scrollDown();

    row.querySelectorAll('[data-remove]').forEach(el=>{
      el.addEventListener('click',()=>{
        const name=el.getAttribute('data-remove');
        state.diseases = state.diseases.filter(x=>x!==name);
        renderDiseaseBubble();
      });
    });
  }

  function askCurrent(){
    err.classList.remove('show');
    const s=steps[idx];
    setHeader(s.section, s.progress);

    input.value='';
    input.disabled=false;
    input.type = (s.type==='date') ? 'date' : 'text';
    input.inputMode = (s.type==='phone') ? 'numeric' : 'text';

    if(s.type==='choice'){
      botBubble(typeof s.ask==='function'?s.ask():s.ask, s.choices);
      input.placeholder='‡∏Å‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡πà‡∏≤...';
    } else if(s.type==='disease'){
      botBubble(typeof s.ask==='function'?s.ask():s.ask, [
        {label:'‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß', value:'none', mint:true},
        {label:'‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÑ‡∏õ‡∏ï‡πà‡∏≠', value:'done'}
      ]);
      renderDiseaseBubble();
      input.placeholder='‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏£‡∏Ñ ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Enter';
    } else if(s.type==='confirm'){
      botBubble(typeof s.ask==='function'?s.ask():s.ask, [
        {label:'‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', value:'send', mint:true},
        {label:'‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç (‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà)', value:'edit'}
      ]);
      input.disabled=true;
      input.placeholder='‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô';
    } else {
      botBubble(typeof s.ask==='function'?s.ask():s.ask);
      input.placeholder = (s.type==='phone') ? '‡πÄ‡∏ä‡πà‡∏ô 08x-xxx-xxxx' : '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö...';
    }
    input.focus();
  }

  function sendAnswer(raw, fromQuick=false, displayLabel=null){
    const s=steps[idx];
    if(!s) return;
    if(s.type==='confirm') return;

    err.classList.remove('show');
    let value = fromQuick ? raw : input.value;

    if(s.type==='disease'){
      if(fromQuick){
        if(value==='none'){
          state.diseases=[];
          meBubble('‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß');
          renderDiseaseBubble();
          return;
        }
        if(value==='done'){
          meBubble('‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß');
          idx++;
          askCurrent();
          return;
        }
      }
      const v=String(value||'').trim();
      if(!v) return;
      if(!state.diseases.includes(v)) state.diseases.push(v);
      meBubble(v);
      input.value='';
      renderDiseaseBubble();
      return;
    }

    let say = displayLabel || value;
    if(s.type==='phone'){ say=formatPhone(value); value=say; }

    const ok=s.validate(value);
    if(!ok){ err.textContent='‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'; err.classList.add('show'); return; }

    s.save(value);
    meBubble(say);

    idx++;
    if(idx < steps.length) askCurrent();
  }

  btnSend.addEventListener('click',()=>sendAnswer(input.value));
  input.addEventListener('keydown',(e)=>{ if(e.key==='Enter'){ e.preventDefault(); sendAnswer(input.value); } });

  chat.addEventListener('click',(e)=>{
    const t=e.target;
    if(!(t && t.dataset && t.dataset.choice)) return;

    const s=steps[idx];
    if(!s || s.type!=='confirm') return;

    const v=t.dataset.choice;
    if(v==='edit'){ meBubble('‡∏Ç‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç'); resetAll(); return; }
    if(v==='send'){
      meBubble('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
      botBubble('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ<br><br><small style="color:#64748B">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠ UI ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° API ‡∏à‡∏£‡∏¥‡∏á‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ</small>');
      progressBar.style.width='100%';
      stepText.textContent='‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô';
      input.disabled=true;
      btnSend.disabled=true;
      btnSend.style.opacity=.55;
    }
  });

  btnReset.addEventListener('click', resetAll);

  function resetAll(){
    Object.keys(state).forEach(k => state[k] = Array.isArray(state[k]) ? [] : '');
    chat.innerHTML='';
    idx=0;
    btnSend.disabled=false;
    btnSend.style.opacity=1;
    input.disabled=false;
    input.type='text';
    input.value='';
    progressBar.style.width='0%';
    stepText.textContent='‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô';
    sectionChip.textContent='‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô';
    sectionSub.textContent='‡∏ñ‡∏≤‡∏°-‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠ (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°)';
    start();
  }

  function start(){
    botBubble('‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ üëã\n‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏´‡∏°‡∏Ñ‡∏∞?');
    askCurrent();
  }

  start();
</script>
</body>
</html>
